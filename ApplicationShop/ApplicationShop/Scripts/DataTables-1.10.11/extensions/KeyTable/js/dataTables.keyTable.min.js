/*! KeyTable 2.1.1
 * ©2009-2016 SpryMedia Ltd - datatables.net/license
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery","datatables.net"],function(t){return n(t,window,document)}):typeof exports=="object"?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){"use strict";var u=n.fn.dataTable,f=function(t,i){if(!u.versionCheck||!u.versionCheck("1.10.8"))throw"KeyTable requires DataTables 1.10.8 or newer";this.c=n.extend(!0,{},u.defaults.keyTable,f.defaults,i);this.s={dt:new u.Api(t),enable:!0,focusDraw:!1};this.dom={};var r=this.s.dt.settings()[0],e=r.keytable;if(e)return e;r.keytable=this;this._constructor()};n.extend(f.prototype,{blur:function(){this._blur()},enable:function(n){this.s.enable=n},focus:function(n,t){this._focus(this.s.dt.cell(n,t))},focused:function(n){var i=this.s.lastFocus,t;return i?(t=this.s.lastFocus.index(),n.row===t.row&&n.column===t.column):!1},_constructor:function(){var u;this._tabInput();var r=this,t=this.s.dt,f=n(t.table().node());f.css("position")==="static"&&f.css("position","relative");n(t.table().body()).on("click.keyTable","th, td",function(){if(r.s.enable!==!1){var n=t.cell(this);n.any()&&r._focus(n)}});n(i).on("keydown.keyTable",function(n){r._key(n)});if(this.c.blurable)n(i).on("click.keyTable",function(i){(n(i.target).parents(".dataTables_filter").length&&r._blur(),n(i.target).parents().filter(t.table().container()).length)||n(i.target).parents("div.DTE").length||r._blur()});if(this.c.editor)t.on("key.keyTable",function(n,t,i,u,f){r._editor(i,f)});if(t.settings()[0].oFeatures.bStateSave)t.on("stateSaveParams.keyTable",function(n,t,i){i.keyTable=r.s.lastFocus?r.s.lastFocus.index():null});t.on("xhr.keyTable",function(){if(!r.s.focusDraw){var n=r.s.lastFocus;if(n){r.s.lastFocus=null;t.one("draw",function(){r._focus(n)})}}});t.on("destroy.keyTable",function(){t.off(".keyTable");n(t.table().body()).off("click.keyTable","th, td");n(i.body).off("keydown.keyTable").off("click.keyTable")});if(u=t.state.loaded(),u&&u.keyTable)t.one("init",function(){var n=t.cell(u.keyTable);n.any()&&n.focus()});else this.c.focus&&t.cell(this.c.focus).focus()},_blur:function(){if(this.s.enable&&this.s.lastFocus){var t=this.s.lastFocus;n(t.node()).removeClass(this.c.className);this.s.lastFocus=null;this._emitEvent("key-blur",[this.s.dt,t])}},_columns:function(){var n=this.s.dt,i=n.columns(this.c.columns).indexes(),t=[];return n.columns(":visible").every(function(n){i.indexOf(n)!==-1&&t.push(n)}),t},_editor:function(t,i){var r=this.s.dt,u=this.c.editor,f;i.stopPropagation();u.inline(this.s.lastFocus.index());f=n("div.DTE input, div.DTE textarea");f.length&&f[0].select();r.keys.enable("navigation-only");r.one("key-blur.editor",function(){u.displayed()&&u.submit()});u.one("close",function(){r.keys.enable(!0);r.off("key-blur.editor")})},_emitEvent:function(t,i){this.s.dt.iterator("table",function(r){n(r.nTable).triggerHandler(t,i)})},_focus:function(r,u){var a=this,e=this.s.dt,f=e.page.info(),v=this.s.lastFocus,h,o,s,c,l;if(this.s.enable){if(typeof r!="number"&&(h=r.index(),u=h.column,r=e.rows({filter:"applied",order:"applied"}).indexes().indexOf(h.row),f.serverSide&&(r+=f.start)),f.length!==-1&&(r<f.start||r>=f.start+f.length)){this.s.focusDraw=!0;e.one("draw",function(){a.s.focusDraw=!1;a._focus(r,u)}).page(Math.floor(r/f.length)).draw(!1);return}if(n.inArray(u,this._columns())!==-1){if(f.serverSide&&(r-=f.start),o=e.cell(":eq("+r+")",u,{search:"applied"}),v){if(v.node()===o.node())return;this._blur()}s=n(o.node());s.addClass(this.c.className);this._scroll(n(t),n(i.body),s,"offset");c=e.table().body().parentNode;c!==e.table().header().parentNode&&(l=n(c.parentNode),this._scroll(l,l,s,"position"));this.s.lastFocus=o;this._emitEvent("key-focus",[this.s.dt,o]);e.state.save()}}},_key:function(t){var r,e,i,u,f;if(this.s.enable&&t.keyCode!==0&&!t.ctrlKey&&!t.metaKey&&!t.altKey&&(r=this.s.lastFocus,r)&&(e=this,i=this.s.dt,!this.c.keys||n.inArray(t.keyCode,this.c.keys)!==-1))switch(t.keyCode){case 9:this._shift(t,t.shiftKey?"left":"right",!0);break;case 27:this.s.blurable&&this.s.enable===!0&&this._blur();break;case 33:case 34:t.preventDefault();u=i.cells({page:"current"}).nodes().indexOf(r.node());i.one("draw",function(){var n=i.cells({page:"current"}).nodes();e._focus(i.cell(u<n.length?n[u]:n[n.length-1]))}).page(t.keyCode===33?"previous":"next").draw(!1);break;case 35:case 36:t.preventDefault();f=i.cells({page:"current"}).indexes();this._focus(i.cell(f[t.keyCode===35?f.length-1:0]));break;case 37:this._shift(t,"left");break;case 38:this._shift(t,"up");break;case 39:this._shift(t,"right");break;case 40:this._shift(t,"down");break;default:this.s.enable===!0&&this._emitEvent("key",[i,t.keyCode,this.s.lastFocus,t])}},_scroll:function(n,t,i,r){var u=i[r](),f=i.outerHeight(),e=i.outerWidth(),o=t.scrollTop(),s=t.scrollLeft(),h=n.height(),c=n.width();u.top<o&&t.scrollTop(u.top);u.left<s&&t.scrollLeft(u.left);u.top+f>o+h&&t.scrollTop(u.top+f-h);u.left+e>s+c&&t.scrollLeft(u.left+e-c)},_shift:function(t,i,r){var v=this,s=this.s.dt,h=s.page.info(),a=h.recordsDisplay,c=this.s.lastFocus,u=this._columns(),l;if(c){l=s.rows({filter:"applied",order:"applied"}).indexes().indexOf(c.index().row);h.serverSide&&(l+=h.start);var o=s.columns(u).indexes().indexOf(c.index().column),f=l,e=u[o];i==="right"?o>=u.length-1?(f++,e=u[0]):e=u[o+1]:i==="left"?o===0?(f--,e=u[u.length-1]):e=u[o-1]:i==="up"?f--:i==="down"&&f++;f>=0&&f<a&&n.inArray(e,u)!==-1?(t.preventDefault(),this._focus(f,e)):r&&this.c.blurable?this._blur():t.preventDefault()}},_tabInput:function(){var u=this,t=this.s.dt,i=this.c.tabIndex!==null?this.c.tabIndex:t.settings()[0].iTabIndex,r;if(i!=-1){r=n('<div><input type="text" tabindex="'+i+'"/><\/div>').css({position:"absolute",height:1,width:0,overflow:"hidden"}).insertBefore(t.table().node());r.children().on("focus",function(){u._focus(t.cell(":eq(0)","0:visible",{page:"current"}))})}}});f.defaults={blurable:!0,className:"focus",columns:"",editor:null,focus:null,keys:null,tabIndex:null};f.version="2.1.1";n.fn.dataTable.KeyTable=f;n.fn.DataTable.KeyTable=f;u.Api.register("cell.blur()",function(){return this.iterator("table",function(n){n.keytable&&n.keytable.blur()})});u.Api.register("cell().focus()",function(){return this.iterator("cell",function(n,t,i){n.keytable&&n.keytable.focus(t,i)})});u.Api.register("keys.disable()",function(){return this.iterator("table",function(n){n.keytable&&n.keytable.enable(!1)})});u.Api.register("keys.enable()",function(n){return this.iterator("table",function(t){t.keytable&&t.keytable.enable(n===r?!0:n)})});u.ext.selector.cell.push(function(n,t,i){var f=t.focused,e=n.keytable,o=[],u,s;if(!e||f===r)return i;for(u=0,s=i.length;u<s;u++)(f===!0&&e.focused(i[u])||f===!1&&!e.focused(i[u]))&&o.push(i[u]);return o});n(i).on("preInit.dt.dtk",function(t,i){var r,e,o;t.namespace==="dt"&&(r=i.oInit.keys,e=u.defaults.keys,(r||e)&&(o=n.extend({},r,e),r!==!1&&new f(i,o)))});return f});
//# sourceMappingURL=dataTables.keyTable.min.js.map
