/*! Buttons for DataTables 1.1.2
 * ©2015 SpryMedia Ltd - datatables.net/license
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery","datatables.net"],function(t){return n(t,window,document)}):typeof exports=="object"?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){"use strict";var u=n.fn.dataTable,c=0,l=0,f=u.ext.buttons,e=function(t,i){i===!0&&(i={});n.isArray(i)&&(i={buttons:i});this.c=n.extend(!0,{},e.defaults,i);i.buttons&&(this.c.buttons=i.buttons);this.s={dt:new u.Api(t),buttons:[],subButtons:[],listenKeys:"",namespace:"dtb"+c++};this.dom={container:n("<"+this.c.dom.container.tag+"/>").addClass(this.c.dom.container.className)};this._constructor()},o,s,h;n.extend(e.prototype,{action:function(n,t){var i=this._indexToButton(n).conf,u=this.s.dt;return t===r?i.action:(i.action=t,this)},active:function(n,t){var i=this._indexToButton(n),u=this.c.dom.button.active;return t===r?i.node.hasClass(u):(i.node.toggleClass(u,t===r?!0:t),this)},add:function(n,t){if(typeof n=="string"&&n.indexOf("-")!==-1){var i=n.split("-");this.c.buttons[i[0]*1].buttons.splice(i[1]*1,0,t)}else this.c.buttons.splice(n*1,0,t);return this.dom.container.empty(),this._buildButtons(this.c.buttons),this},container:function(){return this.dom.container},disable:function(n){var t=this._indexToButton(n);return t.node.addClass(this.c.dom.button.disabled),this},destroy:function(){var f,e,t,i,r,o,u;for(n("body").off("keyup."+this.s.namespace),f=this.s.buttons,e=this.s.subButtons,t=0,i=f.length;t<i;t++)for(this.removePrep(t),r=0,o=e[t].length;r<o;r++)this.removePrep(t+"-"+r);for(this.removeCommit(),this.dom.container.remove(),u=this.s.dt.settings()[0],t=0,i=u.length;t<i;t++)if(u.inst===this){u.splice(t,1);break}return this},enable:function(n,t){if(t===!1)return this.disable(n);var i=this._indexToButton(n);return i.node.removeClass(this.c.dom.button.disabled),this},name:function(){return this.c.name},node:function(n){var t=this._indexToButton(n);return t.node},removeCommit:function(){for(var r=this.s.buttons,i=this.s.subButtons,u,t,n=r.length-1;n>=0;n--)r[n]===null&&(r.splice(n,1),i.splice(n,1),this.c.buttons.splice(n,1));for(n=0,u=i.length;n<u;n++)for(t=i[n].length-1;t>=0;t--)i[n][t]===null&&(i[n].splice(t,1),this.c.buttons[n].buttons.splice(t,1));return this},removePrep:function(n){var t,r=this.s.dt,i;return typeof n=="number"||n.indexOf("-")===-1?(t=this.s.buttons[n*1],t.conf.destroy&&t.conf.destroy.call(r.button(n),r,t,t.conf),t.node.remove(),this._removeKey(t.conf),this.s.buttons[n*1]=null):(i=n.split("-"),t=this.s.subButtons[i[0]*1][i[1]*1],t.conf.destroy&&t.conf.destroy.call(r.button(n),r,t,t.conf),t.node.remove(),this._removeKey(t.conf),this.s.subButtons[i[0]*1][i[1]*1]=null),this},text:function(n,t){var i=this._indexToButton(n),u=this.c.dom.collection.buttonLiner,e=typeof n=="string"&&n.indexOf("-")!==-1&&u&&u.tag?u.tag:this.c.dom.buttonLiner.tag,o=this.s.dt,f=function(n){return typeof n=="function"?n(o,i.node,i.conf):n};return t===r?f(i.conf.text):(i.conf.text=t,e?i.node.children(e).html(f(t)):i.node.html(f(t)),this)},toIndex:function(n){for(var i,f,e=this.s.buttons,u=this.s.subButtons,t=0,r=e.length;t<r;t++)if(e[t].node[0]===n)return t+"";for(t=0,r=u.length;t<r;t++)for(i=0,f=u[t].length;i<f;i++)if(u[t][i].node[0]===n)return t+"-"+i},_constructor:function(){var t=this,u=this.s.dt,r=u.settings()[0];r._buttons||(r._buttons=[]);r._buttons.push({inst:this,name:this.c.name});this._buildButtons(this.c.buttons);u.on("destroy",function(){t.destroy()});n("body").on("keyup."+this.s.namespace,function(n){if(!i.activeElement||i.activeElement===i.body){var r=String.fromCharCode(n.keyCode).toLowerCase();t.s.listenKeys.toLowerCase().indexOf(r)!==-1&&t._keypress(r,n)}})},_addKey:function(t){t.key&&(this.s.listenKeys+=n.isPlainObject(t.key)?t.key.key:t.key)},_buildButtons:function(t,i,u){var c=this.s.dt,l=0,s,a,f,e,o,h;for(i||(i=this.dom.container,this.s.buttons=[],this.s.subButtons=[]),s=0,a=t.length;s<a;s++)if(f=this._resolveExtends(t[s]),f){if(n.isArray(f)){this._buildButtons(f,i,u);continue}(e=this._buildButton(f,u!==r?!0:!1),e)&&(o=e.node,i.append(e.inserter),u===r?(this.s.buttons.push({node:o,conf:f,inserter:e.inserter}),this.s.subButtons.push([])):this.s.subButtons[u].push({node:o,conf:f,inserter:e.inserter}),f.buttons&&(h=this.c.dom.collection,f._collection=n("<"+h.tag+"/>").addClass(h.className),this._buildButtons(f.buttons,f._collection,l)),f.init&&f.init.call(c.button(o),c,o,f),l++)}},_buildButton:function(t,i){var v=this,u=this.c.dom.button,e=this.c.dom.buttonLiner,o=this.c.dom.collection,s=this.s.dt,c=function(n){return typeof n=="function"?n(s,r,t):n},h,r,f,a;return(i&&o.button&&(u=o.button),i&&o.buttonLiner&&(e=o.buttonLiner),t.available&&!t.available(s,t))?!1:(h=function(t,i,r,u){u.action.call(i.button(r),t,i,r,u);n(i.table().node()).triggerHandler("buttons-action.dt",[i.button(r),i,r,u])},r=n("<"+u.tag+"/>").addClass(u.className).attr("tabindex",this.s.dt.settings()[0].iTabIndex).attr("aria-controls",this.s.dt.table().node().id).on("click.dtb",function(n){n.preventDefault();!r.hasClass(u.disabled)&&t.action&&h(n,s,r,t);r.blur()}).on("keyup.dtb",function(n){n.keyCode===13&&!r.hasClass(u.disabled)&&t.action&&h(n,s,r,t)}),e.tag?r.append(n("<"+e.tag+"/>").html(c(t.text)).addClass(e.className)):r.html(c(t.text)),t.enabled===!1&&r.addClass(u.disabled),t.className&&r.addClass(t.className),t.titleAttr&&r.attr("title",t.titleAttr),t.namespace||(t.namespace=".dt-button-"+l++),f=this.c.dom.buttonContainer,a=f&&f.tag?n("<"+f.tag+"/>").addClass(f.className).append(r):r,this._addKey(t),{node:r,inserter:a})},_indexToButton:function(n){if(typeof n=="number"||n.indexOf("-")===-1)return this.s.buttons[n*1];var t=n.split("-");return this.s.subButtons[t[0]*1][t[1]*1]},_keypress:function(t,i){for(var u,s,o=this.s.buttons,e=this.s.subButtons,h=function(r,u){if(r.key)if(r.key===t)u.click();else if(n.isPlainObject(r.key)){if(r.key.key!==t)return;if(r.key.shiftKey&&!i.shiftKey)return;if(r.key.altKey&&!i.altKey)return;if(r.key.ctrlKey&&!i.ctrlKey)return;if(r.key.metaKey&&!i.metaKey)return;u.click()}},r=0,f=o.length;r<f;r++)h(o[r].conf,o[r].node);for(r=0,f=e.length;r<f;r++)for(u=0,s=e[r].length;u<s;u++)h(e[r][u].conf,e[r][u].node)},_removeKey:function(t){if(t.key){var r=n.isPlainObject(t.key)?t.key.key:t.key,i=this.s.listenKeys.split(""),u=n.inArray(r,i);i.splice(u,1);this.s.listenKeys=i.join("")}},_resolveExtends:function(t){var l=this.s.dt,i,e,c=function(i){for(var u=0;!n.isPlainObject(i)&&!n.isArray(i);){if(i===r)return;if(typeof i=="function"){if(i=i(l,t),!i)return!1}else if(typeof i=="string"){if(!f[i])throw"Unknown button type: "+i;i=f[i]}if(u++,u>30)throw"Buttons: Too many iterations";}return n.isArray(i)?i:n.extend({},i)},u,o,s,h;for(t=c(t);t&&t.extend;){if(!f[t.extend])throw"Cannot extend unknown button type: "+t.extend;if(u=c(f[t.extend]),n.isArray(u))return u;if(!u)return!1;if(o=u.className,t=n.extend({},u,t),o&&t.className!==o&&(t.className=o+" "+t.className),s=t.postfixButtons,s){for(t.buttons||(t.buttons=[]),i=0,e=s.length;i<e;i++)t.buttons.push(s[i]);t.postfixButtons=null}if(h=t.prefixButtons,h){for(t.buttons||(t.buttons=[]),i=0,e=h.length;i<e;i++)t.buttons.splice(i,0,h[i]);t.prefixButtons=null}t.extend=u.extend}return t}});e.background=function(t,i,u){u===r&&(u=400);t?n("<div/>").addClass(i).css("display","none").appendTo("body").fadeIn(u):n("body > div."+i).fadeOut(u,function(){n(this).remove()})};e.instanceSelector=function(t,i){if(!t)return n.map(i,function(n){return n.inst});var r=[],f=n.map(i,function(n){return n.name}),u=function(t){var e,s,o;if(n.isArray(t)){for(e=0,s=t.length;e<s;e++)u(t[e]);return}typeof t=="string"?t.indexOf(",")!==-1?u(t.split(",")):(o=n.inArray(n.trim(t),f),o!==-1&&r.push(i[o].inst)):typeof t=="number"&&r.push(i[t].inst)};return u(t),r};e.buttonSelector=function(t,i){for(var o,u=[],f=function(t,i){var e,o,s=[],h,c,a,l;if(n.each(i.s.buttons,function(n,t){t!==null&&s.push({node:t.node[0],name:t.conf.name})}),n.each(i.s.subButtons,function(t,i){n.each(i,function(n,t){t!==null&&s.push({node:t.node[0],name:t.conf.name})})}),h=n.map(s,function(n){return n.node}),n.isArray(t)||t instanceof n){for(e=0,o=t.length;e<o;e++)f(t[e],i);return}if(t===null||t===r||t==="*")for(e=0,o=s.length;e<o;e++)u.push({inst:i,idx:i.toIndex(s[e].node)});else if(typeof t=="number")u.push({inst:i,idx:t});else if(typeof t=="string")if(t.indexOf(",")!==-1)for(c=t.split(","),e=0,o=c.length;e<o;e++)f(n.trim(c[e]),i);else if(t.match(/^\d+(\-\d+)?$/))u.push({inst:i,idx:t});else if(t.indexOf(":name")!==-1)for(a=t.replace(":name",""),e=0,o=s.length;e<o;e++)s[e].name===a&&u.push({inst:i,idx:i.toIndex(s[e].node)});else n(h).filter(t).each(function(){u.push({inst:i,idx:i.toIndex(this)})});else typeof t=="object"&&t.nodeName&&(l=n.inArray(t,h),l!==-1&&u.push({inst:i,idx:i.toIndex(h[l])}))},e=0,s=t.length;e<s;e++)o=t[e],f(i,o);return u};e.defaults={buttons:["copy","excel","csv","pdf","print"],name:"main",tabIndex:0,dom:{container:{tag:"div",className:"dt-buttons"},collection:{tag:"div",className:"dt-button-collection"},button:{tag:"a",className:"dt-button",active:"active",disabled:"disabled"},buttonLiner:{tag:"span",className:""}}};e.version="1.1.2";n.extend(f,{collection:{text:function(n){return n.i18n("buttons.collection","Collection")},className:"buttons-collection",action:function(r,u,f,o){var y=f,s=y.offset(),p=n(u.table().container()),h=!1,l,a,v,c;if(n("div.dt-button-background").length&&(h=n("div.dt-button-collection").offset(),n(i).trigger("click.dtb-collection")),o._collection.addClass(o.collectionLayout).css("display","none").appendTo("body").fadeIn(o.fade),l=o._collection.css("position"),h&&l==="absolute"?o._collection.css({top:h.top+5,left:h.left+5}):l==="absolute"?(o._collection.css({top:s.top+y.outerHeight(),left:s.left}),a=s.left+o._collection.outerWidth(),v=p.offset().left+p.width(),a>v&&o._collection.css("left",s.left-(a-v))):(c=o._collection.height()/2,c>n(t).height()/2&&(c=n(t).height()/2),o._collection.css("marginTop",c*-1)),o.background&&e.background(!0,o.backgroundClassName,o.fade),setTimeout(function(){n("div.dt-button-background").on("click.dtb-collection",function(){});n("body").on("click.dtb-collection",function(t){n(t.target).parents().andSelf().filter(o._collection).length||(o._collection.fadeOut(o.fade,function(){o._collection.detach()}),n("div.dt-button-background").off("click.dtb-collection"),e.background(!1,o.backgroundClassName,o.fade),n("body").off("click.dtb-collection"),u.off("buttons-action.b-internal"))})},10),o.autoClose)u.on("buttons-action.b-internal",function(){n("div.dt-button-background").click()})},background:!0,collectionLayout:"",backgroundClassName:"dt-button-background",autoClose:!1,fade:400},copy:function(n,t){return f.copyHtml5?"copyHtml5":f.copyFlash&&f.copyFlash.available(n,t)?"copyFlash":void 0},csv:function(n,t){return f.csvHtml5&&f.csvHtml5.available(n,t)?"csvHtml5":f.csvFlash&&f.csvFlash.available(n,t)?"csvFlash":void 0},excel:function(n,t){return f.excelHtml5&&f.excelHtml5.available(n,t)?"excelHtml5":f.excelFlash&&f.excelFlash.available(n,t)?"excelFlash":void 0},pdf:function(n,t){return f.pdfHtml5&&f.pdfHtml5.available(n,t)?"pdfHtml5":f.pdfFlash&&f.pdfFlash.available(n,t)?"pdfFlash":void 0},pageLength:function(t){var i=t.settings()[0].aLengthMenu,u=n.isArray(i[0])?i[0]:i,f=n.isArray(i[0])?i[1]:i,r=function(n){return n.i18n("buttons.pageLength",{"-1":"Show all rows",_:"Show %d rows"},n.page.len())};return{extend:"collection",text:r,className:"buttons-page-length",autoClose:!0,buttons:n.map(u,function(n,t){return{text:f[t],action:function(t,i){i.page.len(n).draw()},init:function(t,i,r){var f=this,u=function(){f.active(t.page.len()===n)};t.on("length.dt"+r.namespace,u);u()},destroy:function(n,t,i){n.off("length.dt"+i.namespace)}}}),init:function(n,t,i){var u=this;n.on("length.dt"+i.namespace,function(){u.text(r(n))})},destroy:function(n,t,i){n.off("length.dt"+i.namespace)}}}});u.Api.register("buttons()",function(n,t){return t===r&&(t=n,n=r),this.iterator(!0,"table",function(i){if(i._buttons)return e.buttonSelector(e.instanceSelector(n,i._buttons),t)},!0)});u.Api.register("button()",function(n,t){var i=this.buttons(n,t);return i.length>1&&i.splice(1,i.length),i});u.Api.registerPlural("buttons().active()","button().active()",function(n){return n===r?this.map(function(n){return n.inst.active(n.idx)}):this.each(function(t){t.inst.active(t.idx,n)})});u.Api.registerPlural("buttons().action()","button().action()",function(n){return n===r?this.map(function(n){return n.inst.action(n.idx)}):this.each(function(t){t.inst.action(t.idx,n)})});u.Api.register(["buttons().enable()","button().enable()"],function(n){return this.each(function(t){t.inst.enable(t.idx,n)})});u.Api.register(["buttons().disable()","button().disable()"],function(){return this.each(function(n){n.inst.disable(n.idx)})});u.Api.registerPlural("buttons().nodes()","button().node()",function(){var t=n();return n(this.each(function(n){t=t.add(n.inst.node(n.idx))})),t});u.Api.registerPlural("buttons().text()","button().text()",function(n){return n===r?this.map(function(n){return n.inst.text(n.idx)}):this.each(function(t){t.inst.text(t.idx,n)})});u.Api.registerPlural("buttons().trigger()","button().trigger()",function(){return this.each(function(n){n.inst.node(n.idx).trigger("click")})});u.Api.registerPlural("buttons().containers()","buttons().container()",function(){var t=n();return n(this.each(function(n){t=t.add(n.inst.container())})),t});u.Api.register("button().add()",function(n,t){return this.length===1&&this[0].inst.add(n,t),this.button(n)});u.Api.register("buttons().destroy()",function(){return this.pluck("inst").unique().each(function(n){n.destroy()}),this});u.Api.registerPlural("buttons().remove()","buttons().remove()",function(){return this.each(function(n){n.inst.removePrep(n.idx)}),this.pluck("inst").unique().each(function(n){n.removeCommit()}),this});u.Api.register("buttons.info()",function(t,i,u){var f=this;return t===!1?(n("#datatables_buttons_info").fadeOut(function(){n(this).remove()}),clearTimeout(o),o=null,this):(o&&clearTimeout(o),n("#datatables_buttons_info").length&&n("#datatables_buttons_info").remove(),t=t?"<h2>"+t+"<\/h2>":"",n('<div id="datatables_buttons_info" class="dt-button-info"/>').html(t).append(n("<div/>")[typeof i=="string"?"html":"append"](i)).css("display","none").appendTo("body").fadeIn(),u!==r&&u!==0&&(o=setTimeout(function(){f.buttons.info(!1)},u)),this)});u.Api.register("buttons.exportData()",function(n){if(this.context.length)return h(new u.Api(this.context[0]),n)});s=n("<textarea/>")[0];h=function(t,i){for(var h,u,r=n.extend(!0,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:!0,stripNewlines:!0,decodeEntities:!0,trim:!0,format:{header:function(n){return o(n)},footer:function(n){return o(n)},body:function(n){return o(n)}}},i),o=function(n){return typeof n!="string"?n:(r.stripHtml&&(n=n.replace(/<.*?>/g,"")),r.trim&&(n=n.replace(/^\s+|\s+$/g,"")),r.stripNewlines&&(n=n.replace(/\n/g," ")),r.decodeEntities&&(s.innerHTML=n,n=s.value),n)},c=t.columns(r.columns).indexes().map(function(n){return r.format.header(t.column(n).header().innerHTML,n)}).toArray(),p=t.table().footer()?t.columns(r.columns).indexes().map(function(n){var i=t.column(n).footer();return r.format.footer(i?i.innerHTML:"",n)}).toArray():null,w=t.rows(r.rows,r.modifier).indexes().toArray(),l=t.cells(w,r.columns).render(r.orthogonal).toArray(),f=c.length,a=f>0?l.length/f:0,v=new Array(a),y=0,e=0,b=a;e<b;e++){for(h=new Array(f),u=0;u<f;u++)h[u]=r.format.body(l[y],u,e),y++;v[e]=h}return{header:c,footer:p,body:v}};n.fn.dataTable.Buttons=e;n.fn.DataTable.Buttons=e;n(i).on("init.dt plugin-init.dt",function(n,t){if(n.namespace==="dt"){var i=t.oInit.buttons||u.defaults.buttons;i&&!t._buttons&&new e(t,i).container()}});return u.ext.feature.push({fnInit:function(n){var t=new u.Api(n),i=t.init().buttons||u.defaults.buttons;return new e(t,i).container()},cFeature:"B"}),e});
//# sourceMappingURL=dataTables.buttons.min.js.map
