/*!
 * HTML5 export buttons for Buttons and DataTables.
 * 2015 SpryMedia Ltd - datatables.net/license
 *
 * FileSaver.js (2015-05-07.2) - MIT license
 * Copyright © 2015 Eli Grey - http://eligrey.com
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(t){return n(t,window,document)}):typeof exports=="object"?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),i.fn.dataTable.Buttons||require("datatables.net-buttons")(t,i),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){"use strict";var u=n.fn.dataTable,e=function(n){if(typeof navigator=="undefined"||!/MSIE [1-9]\./.test(navigator.userAgent)){var h=n.document,u=function(){return n.URL||n.webkitURL||n},i=h.createElementNS("http://www.w3.org/1999/xhtml","a"),y="download"in i,p=function(t){var i=h.createEvent("MouseEvents");i.initMouseEvent("click",!0,!1,n,0,0,0,0,0,!1,!1,!1,!1,0,null);t.dispatchEvent(i)},f=n.webkitRequestFileSystem,c=n.requestFileSystem||f||n.mozRequestFileSystem,w=function(t){(n.setImmediate||n.setTimeout)(function(){throw t;},0)},e="application/octet-stream",l=0,b=500,o=function(t){var i=function(){typeof t=="string"?u().revokeObjectURL(t):t.remove()};n.chrome?i():setTimeout(i,b)},s=function(n,t,i){var r,u;for(t=[].concat(t),r=t.length;r--;)if(u=n["on"+t[r]],typeof u=="function")try{u.call(n,i||n)}catch(f){w(f)}},a=function(n){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["﻿",n],{type:n.type}):n},v=function(t,h){t=a(t);var v=this,g=t.type,nt=!1,w,d,tt=function(){s(v,"writestart progress write writeend".split(" "))},b=function(){if((nt||!w)&&(w=u().createObjectURL(t)),d)d.location.href=w;else{var i=n.open(w,"_blank");i===r&&typeof safari!="undefined"&&(n.location.href=w)}v.readyState=v.DONE;tt();o(w)},k=function(n){return function(){if(v.readyState!==v.DONE)return n.apply(this,arguments)}},it={create:!0,exclusive:!1},rt;if(v.readyState=v.INIT,h||(h="download"),y){w=u().createObjectURL(t);i.href=w;i.download=h;p(i);v.readyState=v.DONE;tt();o(w);return}if(n.chrome&&g&&g!==e&&(rt=t.slice||t.webkitSlice,t=rt.call(t,0,t.size,e),nt=!0),f&&h!=="download"&&(h+=".download"),(g===e||f)&&(d=n),!c){b();return}l+=t.size;c(n.TEMPORARY,l,k(function(n){n.root.getDirectory("saved",it,k(function(n){var i=function(){n.getFile(h,it,k(function(n){n.createWriter(k(function(i){i.onwriteend=function(t){d.location.href=n.toURL();v.readyState=v.DONE;s(v,"writeend",t);o(n)};i.onerror=function(){var n=i.error;n.code!==n.ABORT_ERR&&b()};"writestart progress write abort".split(" ").forEach(function(n){i["on"+n]=v["on"+n]});i.write(t);v.abort=function(){i.abort();v.readyState=v.DONE};v.readyState=v.WRITING}),b)}),b)};n.getFile(h,{create:!1},k(function(n){n.remove();i()}),k(function(n){n.code===n.NOT_FOUND_ERR?i():b()}))}),b)}),b)},t=v.prototype,k=function(n,t){return new v(n,t)};return typeof navigator!="undefined"&&navigator.msSaveOrOpenBlob?function(n,t){return navigator.msSaveOrOpenBlob(a(n),t)}:(t.abort=function(){var n=this;n.readyState=n.DONE;s(n,"abort")},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,k)}}(t),o=function(t,i){var u=t.filename==="*"&&t.title!=="*"&&t.title!==r?t.title:t.filename;return typeof u=="function"&&(u=u()),u.indexOf("*")!==-1&&(u=u.replace("*",n("title").text())),u=u.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),i===r||i===!0?u+t.extension:u},l=function(n){var t="Sheet1";return n.sheetName&&(t=n.sheetName.replace(/[\[\]\*\/\\\?\:]/g,"")),t},a=function(t){var i=t.title;return typeof i=="function"&&(i=i()),i.indexOf("*")!==-1?i.replace("*",n("title").text()):i},s=function(n){return n.newline?n.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},h=function(n,t){for(var f=s(t),i=n.buttons.exportData(t.exportOptions),u=t.fieldBoundary,c=t.fieldSeparator,l=new RegExp(u,"g"),a=t.escapeChar!==r?t.escapeChar:"\\",e=function(n){for(var i="",t=0,r=n.length;t<r;t++)t>0&&(i+=c),i+=u?u+(""+n[t]).replace(l,a+u)+u:n[t];return i},v=t.header?e(i.header)+f:"",y=t.footer&&i.footer?f+e(i.footer):"",o=[],h=0,p=i.body.length;h<p;h++)o.push(e(i.body[h]));return{str:v+o.join(f)+y,rows:o.length}},c=function(){return navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&navigator.userAgent.indexOf("Opera")===-1},f={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/><\/Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><\/Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\t<Default Extension="xml" ContentType="application/xml"/>\t<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\t<Default Extension="jpeg" ContentType="image/jpeg"/>\t<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>\t<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/><\/Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\t<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/>\t<workbookPr showInkAnnotation="0" autoCompressPictures="0"/>\t<bookViews>\t\t<workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/>\t<\/bookViews>\t<sheets>\t\t<sheet name="__SHEET_NAME__" sheetId="1" r:id="rId1"/>\t<\/sheets><\/workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">\t<sheetData>\t\t__DATA__\t<\/sheetData><\/worksheet>'};return u.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(n){return n.i18n("buttons.copy","Copy")},action:function(t,r,u,f){var v=h(r,f),c=v.str,o=n("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0}),e,l,a,s;if(f.customize&&(c=f.customize(c,f)),e=n("<textarea readonly/>").val(c).appendTo(o),i.queryCommandSupported("copy")){o.appendTo(r.table().container());e[0].focus();e[0].select();try{i.execCommand("copy");o.remove();r.buttons.info(r.i18n("buttons.copyTitle","Copy to clipboard"),r.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},v.rows),2e3);return}catch(y){}}l=n("<span>"+r.i18n("buttons.copyKeys","Press <i>ctrl<\/i> or <i>⌘<\/i> + <i>C<\/i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"<\/span>").append(o);r.buttons.info(r.i18n("buttons.copyTitle","Copy to clipboard"),l,0);e[0].focus();e[0].select();a=n(l).closest(".dt-button-info");s=function(){a.off("click.buttons-copy");n(i).off(".buttons-copy");r.buttons.info(!1)};a.on("click.buttons-copy",s);n(i).on("keydown.buttons-copy",function(n){n.keyCode===27&&s()}).on("copy.buttons-copy cut.buttons-copy",function(){s()})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1},u.ext.buttons.csvHtml5={className:"buttons-csv buttons-html5",available:function(){return t.FileReader!==r&&t.Blob},text:function(n){return n.i18n("buttons.csv","CSV")},action:function(n,t,r,u){var l=s(u),c=h(t,u).str,f=u.charset;u.customize&&(c=u.customize(c,u));f!==!1?(f||(f=i.characterSet||i.charset),f&&(f=";charset="+f)):f="";e(new Blob([c],{type:"text/csv"+f}),o(u))},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1},u.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return t.FileReader!==r&&t.JSZip!==r&&!c()},text:function(n){return n.i18n("buttons.excel","Excel")},action:function(i,u,s,h){var a="",v=u.buttons.exportData(h.exportOptions),p=function(t){for(var u=[],i=0,f=t.length;i<f;i++)(t[i]===null||t[i]===r)&&(t[i]=""),u.push(typeof t[i]=="number"||t[i].match&&n.trim(t[i]).match(/^-?\d+(\.\d+)?$/)&&t[i].charAt(0)!=="0"?'<c t="n"><v>'+t[i]+"<\/v><\/c>":'<c t="inlineStr"><is><t>'+(t[i].replace?t[i].replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,""):t[i])+"<\/t><\/is><\/c>");return"<row>"+u.join("")+"<\/row>"},y,w;for(h.header&&(a+=p(v.header)),y=0,w=v.body.length;y<w;y++)a+=p(v.body[y]);h.footer&&(a+=p(v.footer));var c=new t.JSZip,b=c.folder("_rels"),k=c.folder("xl"),d=c.folder("xl/_rels"),g=c.folder("xl/worksheets");c.file("[Content_Types].xml",f["[Content_Types].xml"]);b.file(".rels",f["_rels/.rels"]);k.file("workbook.xml",f["xl/workbook.xml"].replace("__SHEET_NAME__",l(h)));d.file("workbook.xml.rels",f["xl/_rels/workbook.xml.rels"]);g.file("sheet1.xml",f["xl/worksheets/sheet1.xml"].replace("__DATA__",a));e(c.generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o(h))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1},u.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return t.FileReader!==r&&t.pdfMake},text:function(n){return n.i18n("buttons.pdf","PDF")},action:function(i,r,u,f){var b=s(f),v=r.buttons.exportData(f.exportOptions),y=[],h,w,l,p;for(f.header&&y.push(n.map(v.header,function(n){return{text:typeof n=="string"?n:n+"",style:"tableHeader"}})),h=0,w=v.body.length;h<w;h++)y.push(n.map(v.body[h],function(n){return{text:typeof n=="string"?n:n+"",style:h%2?"tableBodyEven":"tableBodyOdd"}}));f.footer&&y.push(n.map(v.footer,function(n){return{text:typeof n=="string"?n:n+"",style:"tableFooter"}}));l={pageSize:f.pageSize,pageOrientation:f.orientation,content:[{table:{headerRows:1,body:y},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};f.message&&l.content.unshift({text:f.message,style:"message",margin:[0,0,0,12]});f.title&&l.content.unshift({text:a(f,!1),style:"title",margin:[0,0,0,12]});f.customize&&f.customize(l,f);p=t.pdfMake.createPdf(l);f.download!=="open"||c()?p.getBuffer(function(n){var t=new Blob([n],{type:"application/pdf"});e(t,o(f))}):p.open()},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,message:null,customize:null,download:"download"},u.Buttons});
//# sourceMappingURL=buttons.html5.min.js.map
