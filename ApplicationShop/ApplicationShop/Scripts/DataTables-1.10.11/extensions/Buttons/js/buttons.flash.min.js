/*!
 * Flash export buttons for Buttons and DataTables.
 * 2015 SpryMedia Ltd - datatables.net/license
 *
 * ZeroClipbaord - MIT license
 * Copyright (c) 2012 Joseph Huckaby
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(t){return n(t,window,document)}):typeof exports=="object"?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),i.fn.dataTable.Buttons||require("datatables.net-buttons")(t,i),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){"use strict";var f=n.fn.dataTable,u={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(n){return typeof n=="string"&&(n=i.getElementById(n)),n.addClass||(n.hide=function(){this.style.display="none"},n.show=function(){this.style.display=""},n.addClass=function(n){this.removeClass(n);this.className+=" "+n},n.removeClass=function(n){this.className=this.className.replace(new RegExp("\\s*"+n+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},n.hasClass=function(n){return!!this.className.match(new RegExp("\\s*"+n+"\\s*"))}),n},setMoviePath:function(n){this.moviePath=n},dispatch:function(n,t,i){var r=this.clients[n];r&&r.receiveEvent(t,i)},register:function(n,t){this.clients[n]=t},getDOMObjectPosition:function(n){var t={left:0,top:0,width:n.width?n.width:n.offsetWidth,height:n.height?n.height:n.offsetHeight};for(n.style.width!==""&&(t.width=n.style.width.replace("px","")),n.style.height!==""&&(t.height=n.style.height.replace("px",""));n;)t.left+=n.offsetLeft,t.top+=n.offsetTop,n=n.offsetParent;return t},Client:function(n){this.handlers={};this.id=u.nextId++;this.movieId="ZeroClipboard_TableToolsMovie_"+this.id;u.register(this.id,this);n&&this.glue(n)}};u.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,sheetName:"",glue:function(n,t){var e,r,f;this.domElement=u.$(n);e=99;this.domElement.style.zIndex&&(e=parseInt(this.domElement.style.zIndex,10)+1);r=u.getDOMObjectPosition(this.domElement);this.div=i.createElement("div");f=this.div.style;f.position="absolute";f.left="0px";f.top="0px";f.width=r.width+"px";f.height=r.height+"px";f.zIndex=e;typeof t!="undefined"&&t!==""&&(this.div.title=t);r.width!==0&&r.height!==0&&(this.sized=!0);this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(r.width,r.height).replace(/&/g,"&amp;"))},positionElement:function(){var n=u.getDOMObjectPosition(this.domElement),t=this.div.style,i;if(t.position="absolute",t.width=n.width+"px",t.height=n.height+"px",n.width!==0&&n.height!==0)this.sized=!0;else return;i=this.div.childNodes[0];i.width=n.width;i.height=n.height},getHTML:function(n,t){var i="",r="id="+this.id+"&width="+n+"&height="+t,f;return navigator.userAgent.match(/MSIE/)?(f=location.href.match(/^https/i)?"https://":"http://",i+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+f+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+n+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+u.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+r+'"/><param name="wmode" value="transparent"/><\/object>'):i+='<embed id="'+this.movieId+'" src="'+u.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+n+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+r+'" wmode="transparent" />',i},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){var t=this;this.domElement&&this.div&&(n(this.div).remove(),this.domElement=null,this.div=null,n.each(u.clients,function(n,i){i===t&&delete u.clients[n]}))},reposition:function(n){if(n&&(this.domElement=u.$(n),this.domElement||this.hide()),this.domElement&&this.div){var t=u.getDOMObjectPosition(this.domElement),i=this.div.style;i.left=""+t.left+"px";i.top=""+t.top+"px"}},clearText:function(){this.clipText="";this.ready&&this.movie.clearText()},appendText:function(n){this.clipText+=n;this.ready&&this.movie.appendText(n)},setText:function(n){this.clipText=n;this.ready&&this.movie.setText(n)},setFileName:function(n){this.fileName=n;this.ready&&this.movie.setFileName(n)},setSheetName:function(n){this.sheetName=n;this.ready&&this.movie.setSheetName(n)},setAction:function(n){this.action=n;this.ready&&this.movie.setAction(n)},addEventListener:function(n,t){n=n.toString().toLowerCase().replace(/^on/,"");this.handlers[n]||(this.handlers[n]=[]);this.handlers[n].push(t)},setHandCursor:function(n){this.handCursorEnabled=n;this.ready&&this.movie.setHandCursor(n)},setCSSEffects:function(n){this.cssEffects=!!n},receiveEvent:function(n,r){var f,e,o,u;n=n.toString().toLowerCase().replace(/^on/,"");switch(n){case"load":if(this.movie=i.getElementById(this.movieId),!this.movie){f=this;setTimeout(function(){f.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){f=this;setTimeout(function(){f.receiveEvent("load",null)},100);this.ready=!0;return}this.ready=!0;this.movie.clearText();this.movie.appendText(this.clipText);this.movie.setFileName(this.fileName);this.movie.setAction(this.action);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[n])for(e=0,o=this.handlers[n].length;e<o;e++)u=this.handlers[n][e],typeof u=="function"?u(this,r):typeof u=="object"&&u.length==2?u[0][u[1]](this,r):typeof u=="string"&&t[u](this,r)}};u.hasFlash=function(){try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(n)return!0}catch(t){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==r&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1};t.ZeroClipboard_TableTools=u;var h=function(n,t){var i=t.attr("id");t.parents("html").length?n.glue(t[0],""):setTimeout(function(){h(n,t)},500)},s=function(t,i){var u=t.filename==="*"&&t.title!=="*"&&t.title!==r?t.title:t.filename;return typeof u=="function"&&(u=u()),u.indexOf("*")!==-1&&(u=u.replace("*",n("title").text())),u=u.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),i===r||i===!0?u+t.extension:u},l=function(n){var t="Sheet1";return n.sheetName&&(t=n.sheetName.replace(/[\[\]\*\/\\\?\:]/g,"")),t},a=function(t){var i=t.title;return typeof i=="function"&&(i=i()),i.indexOf("*")!==-1?i.replace("*",n("title").text()):i},e=function(n,t){var r=t.match(/[\s\S]{1,8192}/g)||[],i,u;for(n.clearText(),i=0,u=r.length;i<u;i++)n.appendText(r[i])},v=function(n){return n.newline?n.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},c=function(n,t){for(var f=v(t),i=n.buttons.exportData(t.exportOptions),u=t.fieldBoundary,h=t.fieldSeparator,c=new RegExp(u,"g"),l=t.escapeChar!==r?t.escapeChar:"\\",e=function(n){for(var i="",t=0,r=n.length;t<r;t++)t>0&&(i+=h),i+=u?u+(""+n[t]).replace(c,l+u)+u:n[t];return i},a=t.header?e(i.header)+f:"",y=t.footer&&i.footer?f+e(i.footer):"",o=[],s=0,p=i.body.length;s<p;s++)o.push(e(i.body[s]));return{str:a+o.join(f)+y,rows:o.length}},o={available:function(){return u.hasFlash()},init:function(n,t,i){u.moviePath=f.Buttons.swfPath;var r=new u.Client;r.setHandCursor(!0);r.addEventListener("mouseDown",function(){i._fromFlash=!0;n.button(t[0]).trigger();i._fromFlash=!1});h(r,t);i._flash=r},destroy:function(n,t,i){i._flash.destroy()},fieldSeparator:",",fieldBoundary:'"',exportOptions:{},title:"*",filename:"*",extension:".csv",header:!0,footer:!1};return f.Buttons.swfPath="//cdn.datatables.net/buttons/1.0.0/swf/flashExport.swf",f.Api.register("buttons.resize()",function(){n.each(u.clients,function(n,t){t.domElement!==r&&t.domElement.parentNode&&t.positionElement()})}),f.ext.buttons.copyFlash=n.extend({},o,{className:"buttons-copy buttons-flash",text:function(n){return n.i18n("buttons.copy","Copy")},action:function(n,t,i,r){if(r._fromFlash){var f=r._flash,u=c(t,r),o=r.customize?r.customize(u.str,r):u.str;f.setAction("copy");e(f,o);t.buttons.info(t.i18n("buttons.copyTitle","Copy to clipboard"),t.i18n("buttons.copyInfo",{_:"Copied %d rows to clipboard",1:"Copied 1 row to clipboard"},u.rows),3e3)}},fieldSeparator:"\t",fieldBoundary:""}),f.ext.buttons.csvFlash=n.extend({},o,{className:"buttons-csv buttons-flash",text:function(n){return n.i18n("buttons.csv","CSV")},action:function(n,t,i,r){var u=r._flash,f=c(t,r),o=r.customize?r.customize(f.str,r):f.str;u.setAction("csv");u.setFileName(s(r));e(u,o)},escapeChar:'"'}),f.ext.buttons.excelFlash=n.extend({},o,{className:"buttons-excel buttons-flash",text:function(n){return n.i18n("buttons.excel","Excel")},action:function(t,i,u,f){var o="",h=f._flash,c=i.buttons.exportData(f.exportOptions),v=function(t){for(var u=[],i=0,f=t.length;i<f;i++)(t[i]===null||t[i]===r)&&(t[i]=""),u.push(typeof t[i]=="number"||t[i].match&&n.trim(t[i]).match(/^-?\d+(\.\d+)?$/)&&t[i].charAt(0)!=="0"?'<c t="n"><v>'+t[i]+"<\/v><\/c>":'<c t="inlineStr"><is><t>'+(t[i].replace?t[i].replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x1F\x7F-\x9F]/g,""):t[i])+"<\/t><\/is><\/c>");return"<row>"+u.join("")+"<\/row>"},a,y;for(f.header&&(o+=v(c.header)),a=0,y=c.body.length;a<y;a++)o+=v(c.body[a]);f.footer&&(o+=v(c.footer));h.setAction("excel");h.setFileName(s(f));h.setSheetName(l(f));e(h,o)},extension:".xlsx"}),f.ext.buttons.pdfFlash=n.extend({},o,{className:"buttons-pdf buttons-flash",text:function(n){return n.i18n("buttons.pdf","PDF")},action:function(n,t,i,r){var u=r._flash,f=t.buttons.exportData(r.exportOptions),o=t.table().node().offsetWidth,h=t.columns(r.columns).indexes().map(function(n){return t.column(n).header().offsetWidth/o});u.setAction("pdf");u.setFileName(a(r));e(u,JSON.stringify({title:s(r,!1),message:r.message,colWidth:h.toArray(),orientation:r.orientation,size:r.pageSize,header:r.header?f.header:null,footer:r.footer?f.footer:null,body:f.body}))},extension:".pdf",orientation:"portrait",pageSize:"A4",message:"",newline:"\n"}),f.Buttons});
//# sourceMappingURL=buttons.flash.min.js.map
